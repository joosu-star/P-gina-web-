<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>JAKE.CORPS :: Sistema Militar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    html,body {
      height: 100%; width: 100vw; margin: 0; padding: 0;
      background: #010;
      font-family: "Courier New", Courier, monospace;
      overflow: hidden;
    }
    body {
      color: #00ff00;
      min-height: 100vh;
      box-sizing: border-box;
      position: relative;
      text-shadow: 0 0 8px #00ff00, 0 0 20px #007700;
      font-size: 1em;
      letter-spacing: 0.01em;
      background: #000 url('https://www.transparenttextures.com/patterns/noise.png') repeat;
    }
    #retro-splash {
      position: fixed; z-index: 9999;
      top:0; left:0; width:100vw; height:100vh;
      background: #000 url('https://www.transparenttextures.com/patterns/noise.png') repeat;
      display: flex; align-items: center; justify-content: center;
      flex-direction: column;
      transition: opacity 0.7s;
    }
    .splash-title {
      font-size: 8vw;
      text-align: center;
      color: #00ff00;
      text-shadow: 0 0 40px #00ff00,0 0 10px #0f0;
      letter-spacing: 0.18em;
      font-weight: bold;
      animation: blink-splash 1.1s infinite;
      user-select:none;
    }
    @keyframes blink-splash {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.25; }
    }
    .splash-sub {
      margin-top: 2vw;
      font-size: 1.2vw;
      color: #0f0;
      text-shadow: 0 0 5px #0f0;
      opacity: 0.6;
      user-select: none;
    }
    #terminal-outer {
      position: absolute; top:0;left:0;width:100vw;height:100vh;
      display: flex; flex-direction: column; align-items: center; justify-content: start;
      z-index: 1;
    }
    .terminal-bar {
      width: 100vw; max-width: 900px; margin: 0 auto;
      background: #151;
      border-bottom: 2.5px solid #0f0;
      border-radius: 0 0 12px 12px;
      padding: 0.5em 2em;
      font-size: 1.09em;
      font-weight: bold;
      letter-spacing: 0.01em;
      opacity: 0.95;
      box-shadow: 0 0 22px #0f0;
      user-select: none;
      display: flex; align-items: center;
      transition: background 0.35s, border-color 0.25s, box-shadow 0.25s;
    }
    .dot { width: 13px; height: 13px; border-radius: 50%; margin-right: 7px; display: inline-block; box-shadow: 0 0 7px #333;}
    .dot.red { background: #f55;}
    .dot.yellow { background: #ff5;}
    .dot.green { background: #5f5;}
    .title { color: #00ff00; margin-left: 1em; opacity:0.7;}
    .terminal {
      width: 100vw; max-width: 900px; min-height: 60vh;
      margin: 0 auto; background: rgba(5,15,5,0.92);
      border: 2.5px solid #0f0; border-radius: 0 0 18px 18px;
      box-shadow: 0 0 40px #00ff00, 0 0 80px #080;
      padding: 30px 36px 30px 36px;
      overflow-x: auto; overflow-y: auto;
      font-size: inherit;
      user-select: text;
      margin-bottom: 20px;
      margin-top: 0;
      animation: appear 0.7s cubic-bezier(.39,.58,.57,1.05);
      transition: border-color 0.25s, box-shadow 0.25s, color 0.25s, background 0.25s;
    }
    @media (max-width: 900px) {.terminal, .terminal-bar {max-width: 99vw; padding-left:4vw; padding-right:4vw;}}
    @media (max-width: 700px) {.terminal, .terminal-bar {font-size: 0.93em;}}
    @media (max-width: 430px) {.terminal, .terminal-bar {padding-left:2vw; padding-right:2vw;}}
    @keyframes appear {
      from { opacity: 0; transform: translateY(-40px) scale(0.96);}
      to   { opacity: 1; transform: none;}
    }
    .blink { animation: blink 1s infinite; }
    @keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0;} }
    .highlight {color: #fff; background: #090; padding: 2px 6px; border-radius: 4px;}
    iframe {
      width: 100%; height: 60vh; border: 1px solid #00ff00; margin-top: 20px;
      background: #111;
      box-shadow: 0 0 18px #00ff00;
      border-radius: 8px;
      transition: box-shadow 0.25s, border 0.25s;
      display: block;
    }

    /* Configuración retro en columnas */
    .conf-table {
      display: flex;
      flex-direction: row;
      gap: 2vw;
      margin-top: 2vw;
      margin-bottom: 2vw;
      width: 100%;
      max-width: 95vw;
      justify-content: center;
      align-items: flex-start;
    }
    .conf-col {
      background: rgba(0,32,0,0.13);
      border: 1.5px solid #0f0;
      border-radius: 9px;
      padding: 18px 19px 14px 19px;
      min-width: 180px;
      margin: 0 7px;
      box-shadow: 0 0 12px #0f0a;
      font-size: 1.07em;
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: flex-start;
      position: relative;
      transition: background 0.3s, border-color 0.3s, box-shadow 0.3s;
    }
    .conf-col.selected {
      background: #002800;
      box-shadow: 0 0 25px #0f0;
      border-width: 2.5px;
    }
    .conf-label {
      color:#0f0;font-weight:bold;letter-spacing:0.01em;font-size:1.07em;margin-bottom:6px;
    }
    .conf-btn, .conf-btn-x {
      display:inline-block; color:#0f0; background:none; border:1px solid #0f0; border-radius:5px; padding:2px 13px; font-size:1em; cursor:pointer; margin-right:8px; text-shadow: none;
      transition: color 0.2s, background 0.2s, border-color 0.2s;
    }
    .conf-btn.selected, .conf-btn:hover, .conf-btn-x:hover {background:#0f0; color:#000;}
    .conf-btn-x {
      position: absolute; top:8px; right:10px; border:2.5px solid #0f0; font-size:1.7em; padding:2px 13px 2px 13px; text-align:center; z-index:10; color:#0f0; background:#000;
      transition: background 0.22s, color 0.22s, border-color 0.22s;
    }
    .conf-val {color:#fff; background:#090; padding:2px 7px; border-radius:3px; margin-left: 0.3em;}
    .conf-tip {color:#0f0; opacity:0.6; font-size:0.95em; margin-top: 12px;}
    ::-webkit-scrollbar {width:9px; background:#050;}
    ::-webkit-scrollbar-thumb {background:#194; border-radius:8px;}
    ::selection {background: #00ff00; color:#000;}
  </style>
</head>
<body>
<div id="retro-splash">
  <div class="splash-title">JAKE.CORPS</div>
  <div class="splash-sub">SISTEMA MILITAR DE CONFIABILIDAD MÁXIMA</div>
</div>
<div id="terminal-outer" style="display:none;">
  <div class="terminal-bar" id="terminal-bar">
    <span class="dot red"></span>
    <span class="dot yellow"></span>
    <span class="dot green"></span>
    <span class="title" id="terminal-title">root@jake-corps:~$</span>
  </div>
  <div class="terminal" id="terminal">
    <div id="output"></div>
    <span class="blink" id="cursor" style="font-size:1.02em;">█</span>
    <div id="iframe-container"></div>
  </div>
</div>
<script>
  // --------- SPLASH RETRO --------------
  let splashFinished = false;
  setTimeout(()=>{finishSplash()},2300);
  document.addEventListener("keydown",()=>{if(!splashFinished) finishSplash()});
  document.addEventListener("mousedown",()=>{if(!splashFinished) finishSplash()});
  function finishSplash() {
    splashFinished = true;
    document.getElementById("retro-splash").style.opacity="0";
    setTimeout(()=>{
      document.getElementById("retro-splash").style.display="none";
      document.getElementById("terminal-outer").style.display="flex";
      focusTerminal();
      showMenu();
    },700);
  }

  // --------- ESTADO Y DATOS -------------
  let state = "menu"; // menu, info, docs, docs-cat, conf, exit
  let docsState = ""; // despliegues, operaciones, entrenamientos, informes
  let typing = false;
  let finishedTyping = false;
  let confCursor = 0;
  let confOptions = ["theme","size","sonido","borrar"];
  // Configuración persistente localStorage
  const confThemes = [
    {key:"green",name:"Verde clásico",fg:"#00ff00",bg:"#010", shadow:"#00ff00", shadow2:"#007700", bar:"#151", border:"#0f0", title:"#00ff00"},
    {key:"amber",name:"Ámbar retro",fg:"#ffd700",bg:"#181000", shadow:"#ffd700", shadow2:"#bfa100", bar:"#2b2100", border:"#ffd700", title:"#ffd700"},
    {key:"blue",name:"Ciber azul",fg:"#00e0ff",bg:"#02121c", shadow:"#00e0ff", shadow2:"#007080", bar:"#062330", border:"#00e0ff", title:"#00e0ff"}
  ];
  let config = {
    theme: localStorage.getItem("conf_theme")||"green",
    fontSize: parseFloat(localStorage.getItem("conf_font")||"1.0"),
    sonido: localStorage.getItem("conf_sound")==="true"
  };
  function saveConfig() {
    localStorage.setItem("conf_theme", config.theme);
    localStorage.setItem("conf_font", config.fontSize);
    localStorage.setItem("conf_sound", config.sonido);
  }
  function applyConfig() {
    let th = confThemes.find(t=> t.key===config.theme) || confThemes[0];
    // Fondo y texto
    document.body.style.background = th.bg + " url('https://www.transparenttextures.com/patterns/noise.png')";
    document.body.style.color = th.fg;
    document.body.style.textShadow = `0 0 8px ${th.shadow}, 0 0 20px ${th.shadow2}`;
    document.getElementById("terminal-outer").style.color = th.fg;
    document.body.style.fontSize = config.fontSize+"em";
    // Terminal y barra superior
    let terminals = document.querySelectorAll(".terminal, .terminal-bar");
    terminals.forEach(e=>{
      e.style.borderColor=th.border;
      e.style.color=th.fg;
    });
    document.querySelectorAll(".terminal-bar").forEach(e=>{
      e.style.background=th.bar;
      e.style.boxShadow=`0 0 22px ${th.shadow}`;
    });
    let term = document.querySelector(".terminal");
    if(term) {
      term.style.boxShadow=`0 0 40px ${th.shadow}, 0 0 80px ${th.shadow2}`;
      term.style.color=th.fg;
      term.style.background = `rgba(5,15,5,0.92)`;
      term.style.borderColor=th.border;
    }
    // Título barra superior
    let title = document.getElementById("terminal-title");
    if(title) title.style.color = th.title;
    // Iframe
    document.querySelectorAll("iframe").forEach(e=>{
      e.style.borderColor=th.border;
      e.style.boxShadow=`0 0 18px ${th.shadow}`;
    });
    // Configuración columnas
    document.querySelectorAll(".conf-col").forEach(col=>{
      col.style.borderColor=th.border;
      col.style.boxShadow=`0 0 12px ${th.shadow}80`;
      col.style.color=th.fg;
    });
    document.querySelectorAll(".conf-label").forEach(lbl=>lbl.style.color=th.fg);
    document.querySelectorAll(".conf-tip").forEach(lbl=>lbl.style.color=th.fg);
    document.querySelectorAll(".conf-btn,.conf-btn-x").forEach(btn=>{
      btn.style.borderColor=th.border;
      btn.style.color=th.fg;
    });
  }

  // ----------- DATA: Documentos -----------
  const docs = {
    despliegues: [
      {titulo: "Despliegue Alfa", url: "https://example.com/despliegue-alfa"},
      {titulo: "Despliegue Bravo", url: "https://example.com/despliegue-bravo"}
    ],
    operaciones: [
      {titulo: "Operación Lamento Gris", url: "https://drive.google.com/file/d/1Cb32m7Xj6wDAb-7ieSftT8gYFy3MCCZ9/preview"},
      {titulo: "Operación Bosnia", url: "https://drive.google.com/file/d/1Cb32m7Xj6wDAb-7ieSftT8gYFy3MCCZ9/preview"}
    ],
    entrenamientos: [
      {titulo: "Entrenamiento Básico", url: "https://docs.google.com/document/d/1-fL3KTjELkZ8MVV1b7tek1fKujRVXGMBmHqIY1vPDek/preview"},
      {titulo: "CQB Avanzado", url: "https://docs.google.com/document/d/11hfdHwqIu8Z4aEE3Fn9xvRvM4Clwo0JZd8V11Hm-dD0/preview"}
    ],
    informes: [
      {titulo: "Informe General", url: "https://example.com/informe-general"}
    ]
  };

  // ---------- MENÚES TERMINAL ----------
  function focusTerminal() { document.body.focus(); }
  function typeWriter(text, callback) {
    typing = true; finishedTyping = false;
    const output = document.getElementById("output");
    output.innerHTML = "";
    let i = 0;
    function write() {
      if (i < text.length) {
        let char = text.charAt(i);
        output.innerHTML += (char === "\n") ? "<br>" : char;
        if(config.sonido && char!==" " && char!=="\n") playBeep();
        i++; setTimeout(write, 13);
      } else {
        typing = false; finishedTyping = true;
        document.getElementById("cursor").style.display = "inline";
        if (callback) callback();
      }
    }
    write();
  }
  function showMenu() {
    state = "menu"; docsState="";
    clearIframe();
    let txt =
`ACCESO AUTORIZADO
─────────────────────────────
[1] Información
[2] Documentos
[3] Configuración
[4] Salir

Seleccione una opción con el número correspondiente.`;
    typeWriter(txt, applyConfig);
  }
  function showInfo() {
    state = "info"; clearIframe();
    let txt =
`INFORMACIÓN DEL SERVIDOR
─────────────────────────────
Sistema Operativo Militar de Confidencialidad Máxima

Acceso restringido. Para soporte, contactar al administrador.

[0] Volver`;
    typeWriter(txt, applyConfig);
  }
  function showDocsMenu() {
    state = "docs"; docsState="";
    clearIframe();
    let txt =
`SECCIÓN DE DOCUMENTOS
─────────────────────────────
[1] Despliegues
[2] Operaciones
[3] Entrenamientos
[4] Informes
[0] Volver

Seleccione una categoría.`;
    typeWriter(txt, applyConfig);
  }
  function showDocsCat(cat) {
    state = "docs-cat"; docsState = cat;
    clearIframe();
    let dlist = docs[cat] || [];
    let txt = `DOCUMENTOS - ${cat.charAt(0).toUpperCase()+cat.slice(1)}\n─────────────────────────────\n`;
    if(!dlist.length) txt+="No hay documentos.\n";
    dlist.forEach((doc, idx) => {
      txt += `[${idx+1}] ${doc.titulo}\n`;
    });
    txt += "[0] Volver";
    typeWriter(txt, applyConfig);
  }
  function showDocIframe(idx) {
    let dlist = docs[docsState] || [];
    let doc = dlist[idx];
    if (!doc) return;
    document.getElementById("output").innerHTML = `<span class='highlight'>Documento seleccionado:</span> ${doc.titulo}`;
    document.getElementById("cursor").style.display = "none";
    document.getElementById("iframe-container").innerHTML =
      `<iframe src="${doc.url}" allowfullscreen></iframe>
      <div style="margin-top:16px;"><span class="conf-btn" onclick="showDocsCat('${docsState}')">← Volver</span></div>`;
    applyConfig();
  }
  function clearIframe() {
    document.getElementById("iframe-container").innerHTML = "";
  }

  // --- CONFIG RETRO EN COLUMNAS ---
  function showConfig() {
    state = "conf"; clearIframe();
    applyConfig();
    const themeIdx = confThemes.findIndex(t=>t.key===config.theme);
    let confHtml = `<div style="width: 100%; display: flex; justify-content: flex-end;"><button class="conf-btn-x" onclick="closeConfig()" title="Volver">✖</button></div>`;
    confHtml += `<div class="conf-table">`;
    // Tema
    confHtml += `<div class="conf-col${confCursor===0?' selected':''}">
      <div class="conf-label">Estilo</div>
      ${confThemes.map((th,i)=>
        `<button class="conf-btn${themeIdx===i?' selected':''}" onclick="setTheme('${th.key}')">${th.name}</button>`).join('<br>')}
      <div class="conf-tip">Flechas ←→ o click para cambiar</div>
    </div>`;
    // Tamaño fuente
    confHtml += `<div class="conf-col${confCursor===1?' selected':''}">
      <div class="conf-label">Tamaño de fuente</div>
      <button class="conf-btn" onclick="changeFont(-0.03)">-</button>
      <span class="conf-val">${config.fontSize.toFixed(2)}</span>
      <button class="conf-btn" onclick="changeFont(0.03)">+</button>
      <div class="conf-tip">Flechas ←→ o click para ajustar</div>
    </div>`;
    // Sonido retro
    confHtml += `<div class="conf-col${confCursor===2?' selected':''}">
      <div class="conf-label">Sonido retro</div>
      <button class="conf-btn${config.sonido?' selected':''}" onclick="toggleSound()">${config.sonido?'Activado':'Desactivado'}</button>
      <div class="conf-tip">ENTER / click para alternar</div>
    </div>`;
    // Reset
    confHtml += `<div class="conf-col${confCursor===3?' selected':''}">
      <div class="conf-label">Restablecer</div>
      <button class="conf-btn" onclick="resetConfig()">Restablecer todo</button>
      <div class="conf-tip">ENTER / click para resetear</div>
    </div>`;
    confHtml += `</div><div class="conf-tip" style="margin-top:2vw;">Navegue con ↑ ↓, cambie con ← →, ENTER o click. <br>Volver: <b>✖</b> o Escape.</div>`;
    document.getElementById("output").innerHTML = confHtml;
    document.getElementById("cursor").style.display = "inline";
    finishedTyping = true; typing = false;
    applyConfig();
  }
  function setTheme(key) { config.theme=key; saveConfig(); showConfig(); }
  function changeFont(delta) { config.fontSize=Math.max(0.7,Math.min(1.4,config.fontSize+delta)); saveConfig(); showConfig(); }
  function toggleSound() { config.sonido = !config.sonido; saveConfig(); showConfig(); }
  function resetConfig() { config = {theme:"green", fontSize:1.0, sonido:false}; saveConfig(); showConfig(); }
  function closeConfig() { showMenu(); }

  // ----------- SONIDO RETRO OPCIONAL -----------
  let beepOsc = null;
  function playBeep() {
    if(!window.AudioContext) return;
    if(beepOsc) return;
    let ctx = window._beepCtx || (window._beepCtx = new AudioContext());
    let o = ctx.createOscillator(), g = ctx.createGain();
    o.type = "square";
    o.frequency.value = 1250 + Math.random()*150;
    g.gain.value = 0.035;
    o.connect(g); g.connect(ctx.destination);
    o.start();
    beepOsc = o;
    setTimeout(()=>{o.stop();beepOsc=null}, 15);
  }

  // ----------- MANEJO DE TECLADO PRINCIPAL -----------
  document.addEventListener("keydown", function(event) {
    if (!splashFinished) return;
    if (typing) return;
    const key = event.key;
    if (state === "menu" && finishedTyping) {
      if (key === "1") showInfo();
      else if (key === "2") showDocsMenu();
      else if (key === "3") {confCursor=0; showConfig();}
      else if (key === "4") showExit();
    } else if (state === "info" && finishedTyping) {
      if (key === "0") showMenu();
    } else if (state === "docs" && finishedTyping) {
      if (key === "1") showDocsCat("despliegues");
      else if (key === "2") showDocsCat("operaciones");
      else if (key === "3") showDocsCat("entrenamientos");
      else if (key === "4") showDocsCat("informes");
      else if (key === "0") showMenu();
    } else if (state === "docs-cat" && finishedTyping) {
      if (key === "0") showDocsMenu();
      else {
        let idx = parseInt(key,10)-1;
        if (!isNaN(idx)) showDocIframe(idx);
      }
    } else if (state === "conf" && finishedTyping) {
      // Navegación configuración
      if(key==="ArrowUp") {confCursor=(confCursor+confOptions.length-1)%confOptions.length; showConfig();}
      else if(key==="ArrowDown") {confCursor=(confCursor+1)%confOptions.length; showConfig();}
      else if(key==="ArrowLeft"||key==="ArrowRight"||key==="Enter"||key===" ") {
        let k = confOptions[confCursor];
        if(k==="theme") {
          let idx = confThemes.findIndex(t=>t.key===config.theme);
          if(key==="ArrowLeft") idx=(idx+confThemes.length-1)%confThemes.length;
          else if(key==="ArrowRight") idx=(idx+1)%confThemes.length;
          config.theme=confThemes[idx].key;
          saveConfig(); applyConfig(); showConfig();
        }
        if(k==="size") {
          if(key==="ArrowLeft") config.fontSize=Math.max(0.7,config.fontSize-0.03);
          else if(key==="ArrowRight") config.fontSize=Math.min(1.4,config.fontSize+0.03);
          saveConfig(); applyConfig(); showConfig();
        }
        if(k==="sonido" && (key==="ArrowLeft"||key==="ArrowRight"||key==="Enter"||key===" ")) {
          config.sonido=!config.sonido;
          saveConfig(); showConfig();
        }
        if(k==="borrar" && (key==="Enter"||key===" ")) {
          resetConfig();
        }
      }
      if(key==="0"||key==="Escape") closeConfig();
    } else if (state === "exit" && finishedTyping) {
      showMenu();
    }
  });

  // --------- INICIALIZACIÓN ---------
  window.onload = function() {
    applyConfig();
    // showMenu(); // splash se encarga
  }
</script>
</body>
</html>
